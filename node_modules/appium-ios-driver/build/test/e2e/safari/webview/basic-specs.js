/* globals expect */
'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _desired = require('./desired');

var _desired2 = _interopRequireDefault(_desired);

var _setupBase = require('../../setup-base');

var _setupBase2 = _interopRequireDefault(_setupBase);

var _helpersWebview = require('../../helpers/webview');

var _bluebird = require('bluebird');

var _bluebird2 = _interopRequireDefault(_bluebird);

describe('safari - webview - basics', function () {
  var driver = (0, _setupBase2['default'])(this, _desired2['default'], { noReset: true }).driver;

  describe('context', function () {
    var _this = this;

    it('getting current context should work initially', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(_bluebird2['default'].delay(500));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.getCurrentContext());

          case 4:
            context$3$0.sent.should.be.ok;

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });

  describe('implicit wait', function () {
    var _this2 = this;

    it('should set the implicit wait for finding web elements', function callee$2$0() {
      var before, hasThrown, after;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.implicitWait(7 * 1000));

          case 2:
            before = new Date().getTime() / 1000;
            hasThrown = false;
            context$3$0.prev = 4;
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'notgonnabethere'));

          case 7:
            context$3$0.next = 12;
            break;

          case 9:
            context$3$0.prev = 9;
            context$3$0.t0 = context$3$0['catch'](4);

            hasThrown = true;

          case 12:
            context$3$0.prev = 12;

            hasThrown.should.be.ok;
            return context$3$0.finish(12);

          case 15:
            after = new Date().getTime() / 1000;

            (after - before > 7).should.be.ok;
            context$3$0.next = 19;
            return _regeneratorRuntime.awrap(driver.implicitWait(0));

          case 19:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2, [[4, 9, 12, 15]]);
    });
  });

  describe('window title', function () {
    var _this3 = this;

    beforeEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _helpersWebview.loadWebView)(_desired2['default'], driver));

          case 2:
            return context$3$0.abrupt('return', context$3$0.sent);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this3);
    });

    it('should return a valid title on web view', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.title());

          case 2:
            context$3$0.sent.should.include("I am a page title");

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this3);
    });
  });

  describe('element handling', function () {
    var _this4 = this;

    beforeEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _helpersWebview.loadWebView)(_desired2['default'], driver));

          case 2:
            return context$3$0.abrupt('return', context$3$0.sent);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should find a web element in the web view', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'i_am_an_id'));

          case 2:
            context$3$0.sent.should.exist;

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should find multiple web elements in the web view', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElements('tag name', 'a'));

          case 2:
            context$3$0.sent.should.have.length.above(0);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should fail gracefully to find multiple missing web elements in the web view', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElements('tag name', 'blar'));

          case 2:
            context$3$0.sent.should.have.length(0);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should find element from another element', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('class name', 'border'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElementFromElement('xpath', './form', el));

          case 5:
            context$3$0.sent.should.exist;

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should be able to click links', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('link text', 'i am a link'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap((0, _helpersWebview.spinTitle)('I am another page title', driver));

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should retrieve an element attribute', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'i_am_an_id'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getAttribute('id', el));

          case 5:
            context$3$0.sent.should.be.equal('i_am_an_id');
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.getAttribute('blar', el));

          case 8:
            context$3$0.t0 = context$3$0.sent;
            expect(context$3$0.t0).to.be['null'];

          case 10:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should retrieve implicit attributes', function callee$2$0() {
      var els;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElements('tag name', 'option'));

          case 2:
            els = context$3$0.sent;

            els.should.have.length(3);

            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.getAttribute('index', els[2]));

          case 6:
            context$3$0.sent.should.be.equal('2');

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should retrieve an element text', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'i_am_an_id'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getText(el));

          case 5:
            context$3$0.sent.should.be.equal('I am a div');

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it.skip('should check if two elements are equals', function callee$2$0() {
      var el1, el2;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'i_am_an_id'));

          case 2:
            el1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElement('css selector', '#i_am_an_id'));

          case 5:
            el2 = context$3$0.sent;

            el1.should.be.equal(el2);

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should return the page source', function callee$2$0() {
      var source;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.getPageSource());

          case 2:
            source = context$3$0.sent;

            source.should.include('<html');
            source.should.include('I am a page title');
            source.should.include('i appear 3 times');
            source.should.include('</html>');

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should get current url', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.getUrl());

          case 2:
            context$3$0.sent.should.include('test/guinea-pig');

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should get updated URL without breaking window handles', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('link text', 'i am an anchor link'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.getUrl());

          case 7:
            context$3$0.sent.should.contain('#anchor');
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.getWindowHandles());

          case 10:
            context$3$0.sent.should.be.ok;

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should send keystrokes to specific element', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'comments'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.clear(el));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.setValue('hello world', el));

          case 7:
            context$3$0.next = 9;
            return _regeneratorRuntime.awrap(driver.getAttribute('value', el));

          case 9:
            context$3$0.sent.should.be.equal('hello world');

          case 10:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should send keystrokes to active element', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'comments'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.clear(el));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 7:
            context$3$0.next = 9;
            return _regeneratorRuntime.awrap(driver.keys('hello world'));

          case 9:
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getAttribute('value', el));

          case 11:
            context$3$0.sent.should.be.equal('hello world');

          case 12:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should clear element', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'comments'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.setValue('hello world', el));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.getAttribute('value', el));

          case 7:
            context$3$0.sent.should.have.length.above(0);
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.clear(el));

          case 10:
            context$3$0.next = 12;
            return _regeneratorRuntime.awrap(driver.getAttribute('value', el));

          case 12:
            context$3$0.sent.should.be.equal('');

          case 13:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should say whether an input is selected', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'unchecked_checkbox'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.elementSelected(el));

          case 5:
            context$3$0.sent.should.not.be.ok;
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 8:
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.elementSelected(el));

          case 10:
            context$3$0.sent.should.be.ok;

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should be able to retrieve css properties', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'fbemail'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getCssProperty('background-color', el.ELEMENT));

          case 5:
            context$3$0.sent.should.be.equal('rgba(255, 255, 255, 1)');

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should retrieve an element size', function callee$2$0() {
      var el, size;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'i_am_an_id'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getSize(el));

          case 5:
            size = context$3$0.sent;

            size.width.should.be.above(0);
            size.height.should.be.above(0);

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should get location of an element', function callee$2$0() {
      var el, loc;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'fbemail'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.getLocation(el));

          case 5:
            loc = context$3$0.sent;

            loc.x.should.be.above(0);
            loc.y.should.be.above(0);

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    /**
     * getTagName not supported by mjwp
     */
    it.skip('should retrieve tag name of an element', function callee$2$0() {
      var el, a;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'fbemail'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElement('css selector', 'a'));

          case 5:
            a = context$3$0.sent;
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.getTagName(el));

          case 8:
            context$3$0.sent.should.be.equal('input');
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getTagName(a));

          case 11:
            context$3$0.sent.should.be.equal('a');

          case 12:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should retrieve a window size', function callee$2$0() {
      var size;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.getWindowSize());

          case 2:
            size = context$3$0.sent;

            size.height.should.be.above(0);
            size.width.should.be.above(0);

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should move to an arbitrary x-y element and click on it', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('link text', 'i am a link'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.moveTo(el, 5, 15));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.click(el));

          case 7:
            context$3$0.next = 9;
            return _regeneratorRuntime.awrap((0, _helpersWebview.spinTitle)('I am another page title', driver));

          case 9:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should submit a form', function callee$2$0() {
      var el, form;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        var _this5 = this;

        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'comments'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'jumpContact'));

          case 5:
            form = context$3$0.sent;
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.setValue('This is a comment', el));

          case 8:
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.submit(form.ELEMENT));

          case 10:
            context$3$0.next = 12;
            return _regeneratorRuntime.awrap((0, _helpersWebview.spinWait)(function callee$3$0() {
              var el;
              return _regeneratorRuntime.async(function callee$3$0$(context$4$0) {
                while (1) switch (context$4$0.prev = context$4$0.next) {
                  case 0:
                    context$4$0.next = 2;
                    return _regeneratorRuntime.awrap(driver.findElement('id', 'your_comments'));

                  case 2:
                    el = context$4$0.sent;
                    context$4$0.next = 5;
                    return _regeneratorRuntime.awrap(driver.getText(el));

                  case 5:
                    context$4$0.sent.should.be.equal('Your comments: This is a comment');

                  case 6:
                  case 'end':
                    return context$4$0.stop();
                }
              }, null, _this5);
            }));

          case 12:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should return true when the element is displayed', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('link text', 'i am a link'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.elementDisplayed(el));

          case 5:
            context$3$0.sent.should.be.ok;

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should return false when the element is not displayed', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'invisible div'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.elementDisplayed(el));

          case 5:
            context$3$0.sent.should.not.be.ok;

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should return true when the element is enabled', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('link text', 'i am a link'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.elementEnabled(el));

          case 5:
            context$3$0.sent.should.be.ok;

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should return false when the element is not enabled', function callee$2$0() {
      var el;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'fbemail'));

          case 2:
            el = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.execute('$(\'#fbemail\').attr(\'disabled\', \'disabled\');'));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.elementEnabled(el));

          case 7:
            context$3$0.sent.should.not.be.ok;

          case 8:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should return the active element', function callee$2$0() {
      var testText, el, activeEl;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            testText = 'hi there';
            context$3$0.next = 3;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'i_am_a_textbox'));

          case 3:
            el = context$3$0.sent;
            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.setValue(testText, el));

          case 6:
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.active());

          case 8:
            activeEl = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getAttribute('value', activeEl));

          case 11:
            context$3$0.t0 = testText;
            context$3$0.sent.should.be.equal(context$3$0.t0);

          case 13:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should properly navigate to anchor', function callee$2$0() {
      var curl;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.getUrl());

          case 2:
            curl = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.setUrl(curl));

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });

    it('should be able to refresh', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.refresh());

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this4);
    });
  });
});

/**
 * we have to use try catch to actually halt the process here
 */
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3NhZmFyaS93ZWJ2aWV3L2Jhc2ljLXNwZWNzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7dUJBQ29CLFdBQVc7Ozs7eUJBQ2Isa0JBQWtCOzs7OzhCQUNhLHVCQUF1Qjs7d0JBQzFELFVBQVU7Ozs7QUFHeEIsUUFBUSxDQUFDLDJCQUEyQixFQUFFLFlBQVk7QUFDaEQsTUFBTSxNQUFNLEdBQUcsNEJBQU0sSUFBSSx3QkFBVyxFQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQzs7QUFFNUQsVUFBUSxDQUFDLFNBQVMsRUFBRSxZQUFZOzs7QUFDOUIsTUFBRSxDQUFDLCtDQUErQyxFQUFFOzs7Ozs2Q0FDNUMsc0JBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQzs7Ozs2Q0FDWCxNQUFNLENBQUMsaUJBQWlCLEVBQUU7Ozs2QkFBRSxNQUFNLENBQUMsRUFBRSxDQUFDLEVBQUU7Ozs7Ozs7S0FDaEQsQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDOztBQUVILFVBQVEsQ0FBQyxlQUFlLEVBQUUsWUFBWTs7O0FBQ3BDLE1BQUUsQ0FBQyx1REFBdUQsRUFBRTtVQUd0RCxNQUFNLEVBQ04sU0FBUyxFQWFULEtBQUs7Ozs7OzZDQWhCSCxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7OztBQUUvQixrQkFBTSxHQUFHLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSTtBQUNwQyxxQkFBUyxHQUFHLEtBQUs7Ozs2Q0FNYixNQUFNLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRSxpQkFBaUIsQ0FBQzs7Ozs7Ozs7OztBQUV2RCxxQkFBUyxHQUFHLElBQUksQ0FBQzs7Ozs7QUFFakIscUJBQVMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQzs7OztBQUdyQixpQkFBSyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsSUFBSTs7QUFDdkMs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QztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2UyZS9zYWZhcmkvd2Vidmlldy9iYXNpYy1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbHMgZXhwZWN0ICovXG5pbXBvcnQgZGVzaXJlZCBmcm9tICcuL2Rlc2lyZWQnO1xuaW1wb3J0IHNldHVwIGZyb20gJy4uLy4uL3NldHVwLWJhc2UnO1xuaW1wb3J0IHsgbG9hZFdlYlZpZXcsIHNwaW5UaXRsZSwgc3BpbldhaXQgfSBmcm9tICcuLi8uLi9oZWxwZXJzL3dlYnZpZXcnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuXG5cbmRlc2NyaWJlKCdzYWZhcmkgLSB3ZWJ2aWV3IC0gYmFzaWNzJywgZnVuY3Rpb24gKCkge1xuICBjb25zdCBkcml2ZXIgPSBzZXR1cCh0aGlzLCBkZXNpcmVkLCB7bm9SZXNldDogdHJ1ZX0pLmRyaXZlcjtcblxuICBkZXNjcmliZSgnY29udGV4dCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnZ2V0dGluZyBjdXJyZW50IGNvbnRleHQgc2hvdWxkIHdvcmsgaW5pdGlhbGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgQi5kZWxheSg1MDApO1xuICAgICAgKGF3YWl0IGRyaXZlci5nZXRDdXJyZW50Q29udGV4dCgpKS5zaG91bGQuYmUub2s7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpbXBsaWNpdCB3YWl0JywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgc2V0IHRoZSBpbXBsaWNpdCB3YWl0IGZvciBmaW5kaW5nIHdlYiBlbGVtZW50cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5pbXBsaWNpdFdhaXQoNyAqIDEwMDApO1xuXG4gICAgICBsZXQgYmVmb3JlID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwO1xuICAgICAgbGV0IGhhc1Rocm93biA9IGZhbHNlO1xuXG4gICAgICAvKipcbiAgICAgICAqIHdlIGhhdmUgdG8gdXNlIHRyeSBjYXRjaCB0byBhY3R1YWxseSBoYWx0IHRoZSBwcm9jZXNzIGhlcmVcbiAgICAgICAqL1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd0YWcgbmFtZScsICdub3Rnb25uYWJldGhlcmUnKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaGFzVGhyb3duID0gdHJ1ZTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGhhc1Rocm93bi5zaG91bGQuYmUub2s7XG4gICAgICB9XG5cbiAgICAgIGxldCBhZnRlciA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMDtcbiAgICAgICgoYWZ0ZXIgLSBiZWZvcmUpID4gNykuc2hvdWxkLmJlLm9rO1xuICAgICAgYXdhaXQgZHJpdmVyLmltcGxpY2l0V2FpdCgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3dpbmRvdyB0aXRsZScsIGZ1bmN0aW9uICgpIHtcbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IGF3YWl0IGxvYWRXZWJWaWV3KGRlc2lyZWQsIGRyaXZlcikpO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYSB2YWxpZCB0aXRsZSBvbiB3ZWIgdmlldycsIGFzeW5jICgpID0+IHtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmluY2x1ZGUoXCJJIGFtIGEgcGFnZSB0aXRsZVwiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2VsZW1lbnQgaGFuZGxpbmcnLCBmdW5jdGlvbiAoKSB7XG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiBhd2FpdCBsb2FkV2ViVmlldyhkZXNpcmVkLCBkcml2ZXIpKTtcblxuICAgIGl0KCdzaG91bGQgZmluZCBhIHdlYiBlbGVtZW50IGluIHRoZSB3ZWIgdmlldycsIGFzeW5jICgpID0+IHtcbiAgICAgIChhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2lkJywgJ2lfYW1fYW5faWQnKSkuc2hvdWxkLmV4aXN0O1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaW5kIG11bHRpcGxlIHdlYiBlbGVtZW50cyBpbiB0aGUgd2ViIHZpZXcnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50cygndGFnIG5hbWUnLCAnYScpKS5zaG91bGQuaGF2ZS5sZW5ndGguYWJvdmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZhaWwgZ3JhY2VmdWxseSB0byBmaW5kIG11bHRpcGxlIG1pc3Npbmcgd2ViIGVsZW1lbnRzIGluIHRoZSB3ZWIgdmlldycsIGFzeW5jICgpID0+IHtcbiAgICAgIChhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzKCd0YWcgbmFtZScsICdibGFyJykpLnNob3VsZC5oYXZlLmxlbmd0aCgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmluZCBlbGVtZW50IGZyb20gYW5vdGhlciBlbGVtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdjbGFzcyBuYW1lJywgJ2JvcmRlcicpO1xuICAgICAgKGF3YWl0IGRyaXZlci5maW5kRWxlbWVudEZyb21FbGVtZW50KCd4cGF0aCcsICcuL2Zvcm0nLCBlbCkpLnNob3VsZC5leGlzdDtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYmUgYWJsZSB0byBjbGljayBsaW5rcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnbGluayB0ZXh0JywgJ2kgYW0gYSBsaW5rJyk7XG4gICAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWwpO1xuICAgICAgYXdhaXQgc3BpblRpdGxlKCdJIGFtIGFub3RoZXIgcGFnZSB0aXRsZScsIGRyaXZlcik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHJpZXZlIGFuIGVsZW1lbnQgYXR0cmlidXRlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdpZCcsICdpX2FtX2FuX2lkJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgnaWQnLCBlbCkpLnNob3VsZC5iZS5lcXVhbCgnaV9hbV9hbl9pZCcpO1xuICAgICAgZXhwZWN0KGF3YWl0IGRyaXZlci5nZXRBdHRyaWJ1dGUoJ2JsYXInLCBlbCkpLnRvLmJlLm51bGw7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHJpZXZlIGltcGxpY2l0IGF0dHJpYnV0ZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWxzID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50cygndGFnIG5hbWUnLCAnb3B0aW9uJyk7XG4gICAgICBlbHMuc2hvdWxkLmhhdmUubGVuZ3RoKDMpO1xuXG4gICAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgnaW5kZXgnLCBlbHNbMl0pKS5zaG91bGQuYmUuZXF1YWwoJzInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0cmlldmUgYW4gZWxlbWVudCB0ZXh0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdpZCcsICdpX2FtX2FuX2lkJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoZWwpKS5zaG91bGQuYmUuZXF1YWwoJ0kgYW0gYSBkaXYnKTtcbiAgICB9KTtcblxuICAgIGl0LnNraXAoJ3Nob3VsZCBjaGVjayBpZiB0d28gZWxlbWVudHMgYXJlIGVxdWFscycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2lkJywgJ2lfYW1fYW5faWQnKTtcbiAgICAgIGxldCBlbDIgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2NzcyBzZWxlY3RvcicsICcjaV9hbV9hbl9pZCcpO1xuICAgICAgZWwxLnNob3VsZC5iZS5lcXVhbChlbDIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdGhlIHBhZ2Ugc291cmNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IHNvdXJjZSA9IGF3YWl0IGRyaXZlci5nZXRQYWdlU291cmNlKCk7XG4gICAgICBzb3VyY2Uuc2hvdWxkLmluY2x1ZGUoJzxodG1sJyk7XG4gICAgICBzb3VyY2Uuc2hvdWxkLmluY2x1ZGUoJ0kgYW0gYSBwYWdlIHRpdGxlJyk7XG4gICAgICBzb3VyY2Uuc2hvdWxkLmluY2x1ZGUoJ2kgYXBwZWFyIDMgdGltZXMnKTtcbiAgICAgIHNvdXJjZS5zaG91bGQuaW5jbHVkZSgnPC9odG1sPicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgY3VycmVudCB1cmwnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFVybCgpKS5zaG91bGQuaW5jbHVkZSgndGVzdC9ndWluZWEtcGlnJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdldCB1cGRhdGVkIFVSTCB3aXRob3V0IGJyZWFraW5nIHdpbmRvdyBoYW5kbGVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdsaW5rIHRleHQnLCAnaSBhbSBhbiBhbmNob3IgbGluaycpO1xuICAgICAgYXdhaXQgZHJpdmVyLmNsaWNrKGVsKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VXJsKCkpLnNob3VsZC5jb250YWluKCcjYW5jaG9yJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFdpbmRvd0hhbmRsZXMoKSkuc2hvdWxkLmJlLm9rO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzZW5kIGtleXN0cm9rZXMgdG8gc3BlY2lmaWMgZWxlbWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnY29tbWVudHMnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5jbGVhcihlbCk7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0VmFsdWUoJ2hlbGxvIHdvcmxkJywgZWwpO1xuICAgICAgKGF3YWl0IGRyaXZlci5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgZWwpKS5zaG91bGQuYmUuZXF1YWwoJ2hlbGxvIHdvcmxkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNlbmQga2V5c3Ryb2tlcyB0byBhY3RpdmUgZWxlbWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnY29tbWVudHMnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5jbGVhcihlbCk7XG4gICAgICBhd2FpdCBkcml2ZXIuY2xpY2soZWwpO1xuICAgICAgYXdhaXQgZHJpdmVyLmtleXMoJ2hlbGxvIHdvcmxkJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgndmFsdWUnLCBlbCkpLnNob3VsZC5iZS5lcXVhbCgnaGVsbG8gd29ybGQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgZWxlbWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnY29tbWVudHMnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRWYWx1ZSgnaGVsbG8gd29ybGQnLCBlbCk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgndmFsdWUnLCBlbCkpLnNob3VsZC5oYXZlLmxlbmd0aC5hYm92ZSgwKTtcbiAgICAgIGF3YWl0IGRyaXZlci5jbGVhcihlbCk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldEF0dHJpYnV0ZSgndmFsdWUnLCBlbCkpLnNob3VsZC5iZS5lcXVhbCgnJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNheSB3aGV0aGVyIGFuIGlucHV0IGlzIHNlbGVjdGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdpZCcsICd1bmNoZWNrZWRfY2hlY2tib3gnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZWxlbWVudFNlbGVjdGVkKGVsKSkuc2hvdWxkLm5vdC5iZS5vaztcbiAgICAgIGF3YWl0IGRyaXZlci5jbGljayhlbCk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmVsZW1lbnRTZWxlY3RlZChlbCkpLnNob3VsZC5iZS5vaztcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYmUgYWJsZSB0byByZXRyaWV2ZSBjc3MgcHJvcGVydGllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnZmJlbWFpbCcpO1xuICAgICAgKGF3YWl0IGRyaXZlci5nZXRDc3NQcm9wZXJ0eSgnYmFja2dyb3VuZC1jb2xvcicsIGVsLkVMRU1FTlQpKS5zaG91bGQuYmUuZXF1YWwoJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMSknKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0cmlldmUgYW4gZWxlbWVudCBzaXplJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdpZCcsICdpX2FtX2FuX2lkJyk7XG4gICAgICBsZXQgc2l6ZSA9IGF3YWl0IGRyaXZlci5nZXRTaXplKGVsKTtcbiAgICAgIHNpemUud2lkdGguc2hvdWxkLmJlLmFib3ZlKDApO1xuICAgICAgc2l6ZS5oZWlnaHQuc2hvdWxkLmJlLmFib3ZlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgbG9jYXRpb24gb2YgYW4gZWxlbWVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnZmJlbWFpbCcpO1xuICAgICAgbGV0IGxvYyA9IGF3YWl0IGRyaXZlci5nZXRMb2NhdGlvbihlbCk7XG4gICAgICBsb2MueC5zaG91bGQuYmUuYWJvdmUoMCk7XG4gICAgICBsb2MueS5zaG91bGQuYmUuYWJvdmUoMCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBnZXRUYWdOYW1lIG5vdCBzdXBwb3J0ZWQgYnkgbWp3cFxuICAgICAqL1xuICAgIGl0LnNraXAoJ3Nob3VsZCByZXRyaWV2ZSB0YWcgbmFtZSBvZiBhbiBlbGVtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdpZCcsICdmYmVtYWlsJyk7XG4gICAgICBsZXQgYSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnY3NzIHNlbGVjdG9yJywgJ2EnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGFnTmFtZShlbCkpLnNob3VsZC5iZS5lcXVhbCgnaW5wdXQnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGFnTmFtZShhKSkuc2hvdWxkLmJlLmVxdWFsKCdhJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHJpZXZlIGEgd2luZG93IHNpemUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgc2l6ZSA9IGF3YWl0IGRyaXZlci5nZXRXaW5kb3dTaXplKCk7XG4gICAgICBzaXplLmhlaWdodC5zaG91bGQuYmUuYWJvdmUoMCk7XG4gICAgICBzaXplLndpZHRoLnNob3VsZC5iZS5hYm92ZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbW92ZSB0byBhbiBhcmJpdHJhcnkgeC15IGVsZW1lbnQgYW5kIGNsaWNrIG9uIGl0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdsaW5rIHRleHQnLCAnaSBhbSBhIGxpbmsnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5tb3ZlVG8oZWwsIDUsIDE1KTtcbiAgICAgIGF3YWl0IGRyaXZlci5jbGljayhlbCk7XG4gICAgICBhd2FpdCBzcGluVGl0bGUoJ0kgYW0gYW5vdGhlciBwYWdlIHRpdGxlJywgZHJpdmVyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgc3VibWl0IGEgZm9ybScsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnY29tbWVudHMnKTtcbiAgICAgIGxldCBmb3JtID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdpZCcsICdqdW1wQ29udGFjdCcpO1xuICAgICAgYXdhaXQgZHJpdmVyLnNldFZhbHVlKCdUaGlzIGlzIGEgY29tbWVudCcsIGVsKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zdWJtaXQoZm9ybS5FTEVNRU5UKTtcbiAgICAgIGF3YWl0IHNwaW5XYWl0KGFzeW5jICgpID0+IHtcbiAgICAgICAgbGV0IGVsID0gYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCdpZCcsICd5b3VyX2NvbW1lbnRzJyk7XG4gICAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChlbCkpLnNob3VsZC5iZS5lcXVhbCgnWW91ciBjb21tZW50czogVGhpcyBpcyBhIGNvbW1lbnQnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSB3aGVuIHRoZSBlbGVtZW50IGlzIGRpc3BsYXllZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnbGluayB0ZXh0JywgJ2kgYW0gYSBsaW5rJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmVsZW1lbnREaXNwbGF5ZWQoZWwpKS5zaG91bGQuYmUub2s7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSB3aGVuIHRoZSBlbGVtZW50IGlzIG5vdCBkaXNwbGF5ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZWwgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2lkJywgJ2ludmlzaWJsZSBkaXYnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZWxlbWVudERpc3BsYXllZChlbCkpLnNob3VsZC5ub3QuYmUub2s7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIHdoZW4gdGhlIGVsZW1lbnQgaXMgZW5hYmxlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnbGluayB0ZXh0JywgJ2kgYW0gYSBsaW5rJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmVsZW1lbnRFbmFibGVkKGVsKSkuc2hvdWxkLmJlLm9rO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2Ugd2hlbiB0aGUgZWxlbWVudCBpcyBub3QgZW5hYmxlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnZmJlbWFpbCcpO1xuICAgICAgYXdhaXQgZHJpdmVyLmV4ZWN1dGUoYCQoJyNmYmVtYWlsJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtgKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZWxlbWVudEVuYWJsZWQoZWwpKS5zaG91bGQubm90LmJlLm9rO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdGhlIGFjdGl2ZSBlbGVtZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgdmFyIHRlc3RUZXh0ID0gJ2hpIHRoZXJlJztcbiAgICAgIGxldCBlbCA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnaV9hbV9hX3RleHRib3gnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRWYWx1ZSh0ZXN0VGV4dCwgZWwpO1xuICAgICAgbGV0IGFjdGl2ZUVsID0gYXdhaXQgZHJpdmVyLmFjdGl2ZSgpO1xuICAgICAgKGF3YWl0IGRyaXZlci5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgYWN0aXZlRWwpKS5zaG91bGQuYmUuZXF1YWwodGVzdFRleHQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBwcm9wZXJseSBuYXZpZ2F0ZSB0byBhbmNob3InLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgY3VybCA9IGF3YWl0IGRyaXZlci5nZXRVcmwoKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRVcmwoY3VybCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGJlIGFibGUgdG8gcmVmcmVzaCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5yZWZyZXNoKCk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uLy4uLy4uIn0=
