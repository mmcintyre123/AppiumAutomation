'use strict';

var _get = require('babel-runtime/helpers/get')['default'];

var _inherits = require('babel-runtime/helpers/inherits')['default'];

var _createClass = require('babel-runtime/helpers/create-class')['default'];

var _classCallCheck = require('babel-runtime/helpers/class-call-check')['default'];

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _simulatorXcode7 = require('./simulator-xcode-7');

var _simulatorXcode72 = _interopRequireDefault(_simulatorXcode7);

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

// these sims are sloooooooow
var STARTUP_TIMEOUT = 120 * 1000;

var SimulatorXcode8 = (function (_SimulatorXcode7) {
  _inherits(SimulatorXcode8, _SimulatorXcode7);

  function SimulatorXcode8(udid, xcodeVersion) {
    _classCallCheck(this, SimulatorXcode8);

    _get(Object.getPrototypeOf(SimulatorXcode8.prototype), 'constructor', this).call(this, udid, xcodeVersion);

    // list of files to check for when seeing if a simulator is "fresh"
    // (meaning it has never been booted).
    // If these files are present, we assume it's been successfully booted
    this.isFreshFiles = ['Library/Cookies', 'Library/Preferences/.GlobalPreferences.plist', 'Library/Preferences/com.apple.springboard.plist', 'var/run/syslog.pid'];

    this.extraStartupTime = 10000;
  }

  _createClass(SimulatorXcode8, [{
    key: 'getBootedIndicatorString',
    value: function getBootedIndicatorString() {
      var indicator, platformVersion;
      return _regeneratorRuntime.async(function getBootedIndicatorString$(context$2$0) {
        while (1) switch (context$2$0.prev = context$2$0.next) {
          case 0:
            indicator = undefined;
            context$2$0.next = 3;
            return _regeneratorRuntime.awrap(this.getPlatformVersion());

          case 3:
            platformVersion = context$2$0.sent;
            context$2$0.t0 = platformVersion;
            context$2$0.next = context$2$0.t0 === '9.0' ? 7 : context$2$0.t0 === '9.1' ? 7 : context$2$0.t0 === '9.2' ? 7 : context$2$0.t0 === '9.3' ? 7 : context$2$0.t0 === '10.0' ? 9 : context$2$0.t0 === '10.1' ? 9 : context$2$0.t0 === '10.2' ? 9 : 11;
            break;

          case 7:
            indicator = 'System app "com.apple.springboard" finished startup';
            return context$2$0.abrupt('break', 13);

          case 9:
            indicator = 'SMS Plugin initialized';
            return context$2$0.abrupt('break', 13);

          case 11:
            _logger2['default'].warn('No boot indicator case for platform version \'' + platformVersion + '\'');
            indicator = 'no boot indicator string available';

          case 13:
            return context$2$0.abrupt('return', indicator);

          case 14:
          case 'end':
            return context$2$0.stop();
        }
      }, null, this);
    }
  }, {
    key: 'startupTimeout',
    get: function get() {
      return STARTUP_TIMEOUT;
    }
  }]);

  return SimulatorXcode8;
})(_simulatorXcode72['default']);

exports['default'] = SimulatorXcode8;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zaW11bGF0b3IteGNvZGUtOC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7K0JBQTRCLHFCQUFxQjs7OztzQkFDakMsVUFBVTs7Ozs7QUFJMUIsSUFBTSxlQUFlLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQzs7SUFFN0IsZUFBZTtZQUFmLGVBQWU7O0FBQ1AsV0FEUixlQUFlLENBQ04sSUFBSSxFQUFFLFlBQVksRUFBRTswQkFEN0IsZUFBZTs7QUFFakIsK0JBRkUsZUFBZSw2Q0FFWCxJQUFJLEVBQUUsWUFBWSxFQUFFOzs7OztBQUsxQixRQUFJLENBQUMsWUFBWSxHQUFHLENBQ2xCLGlCQUFpQixFQUNqQiw4Q0FBOEMsRUFDOUMsaURBQWlELEVBQ2pELG9CQUFvQixDQUNyQixDQUFDOztBQUVGLFFBQUksQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUM7R0FDL0I7O2VBZkcsZUFBZTs7V0FxQlk7VUFDekIsU0FBUyxFQUNULGVBQWU7Ozs7QUFEZixxQkFBUzs7NkNBQ2UsSUFBSSxDQUFDLGtCQUFrQixFQUFFOzs7QUFBakQsMkJBQWU7NkJBQ1gsZUFBZTtrREFDaEIsS0FBSywwQkFDTCxLQUFLLDBCQUNMLEtBQUssMEJBQ0wsS0FBSywwQkFHTCxNQUFNLDBCQUNOLE1BQU0sMEJBQ04sTUFBTTs7OztBQUpULHFCQUFTLEdBQUcscURBQXFELENBQUM7Ozs7QUFLbEUscUJBQVMsR0FBRyx3QkFBd0IsQ0FBQzs7OztBQUdyQyxnQ0FBSSxJQUFJLG9EQUFpRCxlQUFlLFFBQUksQ0FBQztBQUM3RSxxQkFBUyxHQUFHLG9DQUFvQyxDQUFDOzs7Z0RBRTlDLFNBQVM7Ozs7Ozs7S0FDakI7OztTQXhCa0IsZUFBRztBQUNwQixhQUFPLGVBQWUsQ0FBQztLQUN4Qjs7O1NBbkJHLGVBQWU7OztxQkE2Q04sZUFBZSIsImZpbGUiOiJsaWIvc2ltdWxhdG9yLXhjb2RlLTguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU2ltdWxhdG9yWGNvZGU3IGZyb20gJy4vc2ltdWxhdG9yLXhjb2RlLTcnO1xuaW1wb3J0IGxvZyBmcm9tICcuL2xvZ2dlcic7XG5cblxuLy8gdGhlc2Ugc2ltcyBhcmUgc2xvb29vb29vb3dcbmNvbnN0IFNUQVJUVVBfVElNRU9VVCA9IDEyMCAqIDEwMDA7XG5cbmNsYXNzIFNpbXVsYXRvclhjb2RlOCBleHRlbmRzIFNpbXVsYXRvclhjb2RlNyB7XG4gIGNvbnN0cnVjdG9yICh1ZGlkLCB4Y29kZVZlcnNpb24pIHtcbiAgICBzdXBlcih1ZGlkLCB4Y29kZVZlcnNpb24pO1xuXG4gICAgLy8gbGlzdCBvZiBmaWxlcyB0byBjaGVjayBmb3Igd2hlbiBzZWVpbmcgaWYgYSBzaW11bGF0b3IgaXMgXCJmcmVzaFwiXG4gICAgLy8gKG1lYW5pbmcgaXQgaGFzIG5ldmVyIGJlZW4gYm9vdGVkKS5cbiAgICAvLyBJZiB0aGVzZSBmaWxlcyBhcmUgcHJlc2VudCwgd2UgYXNzdW1lIGl0J3MgYmVlbiBzdWNjZXNzZnVsbHkgYm9vdGVkXG4gICAgdGhpcy5pc0ZyZXNoRmlsZXMgPSBbXG4gICAgICAnTGlicmFyeS9Db29raWVzJyxcbiAgICAgICdMaWJyYXJ5L1ByZWZlcmVuY2VzLy5HbG9iYWxQcmVmZXJlbmNlcy5wbGlzdCcsXG4gICAgICAnTGlicmFyeS9QcmVmZXJlbmNlcy9jb20uYXBwbGUuc3ByaW5nYm9hcmQucGxpc3QnLFxuICAgICAgJ3Zhci9ydW4vc3lzbG9nLnBpZCdcbiAgICBdO1xuXG4gICAgdGhpcy5leHRyYVN0YXJ0dXBUaW1lID0gMTAwMDA7XG4gIH1cblxuICBnZXQgc3RhcnR1cFRpbWVvdXQgKCkge1xuICAgIHJldHVybiBTVEFSVFVQX1RJTUVPVVQ7XG4gIH1cblxuICBhc3luYyBnZXRCb290ZWRJbmRpY2F0b3JTdHJpbmcgKCkge1xuICAgIGxldCBpbmRpY2F0b3I7XG4gICAgbGV0IHBsYXRmb3JtVmVyc2lvbiA9IGF3YWl0IHRoaXMuZ2V0UGxhdGZvcm1WZXJzaW9uKCk7XG4gICAgc3dpdGNoIChwbGF0Zm9ybVZlcnNpb24pIHtcbiAgICAgIGNhc2UgJzkuMCc6XG4gICAgICBjYXNlICc5LjEnOlxuICAgICAgY2FzZSAnOS4yJzpcbiAgICAgIGNhc2UgJzkuMyc6XG4gICAgICAgIGluZGljYXRvciA9ICdTeXN0ZW0gYXBwIFwiY29tLmFwcGxlLnNwcmluZ2JvYXJkXCIgZmluaXNoZWQgc3RhcnR1cCc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnMTAuMCc6XG4gICAgICBjYXNlICcxMC4xJzpcbiAgICAgIGNhc2UgJzEwLjInOlxuICAgICAgICBpbmRpY2F0b3IgPSAnU01TIFBsdWdpbiBpbml0aWFsaXplZCc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgbG9nLndhcm4oYE5vIGJvb3QgaW5kaWNhdG9yIGNhc2UgZm9yIHBsYXRmb3JtIHZlcnNpb24gJyR7cGxhdGZvcm1WZXJzaW9ufSdgKTtcbiAgICAgICAgaW5kaWNhdG9yID0gJ25vIGJvb3QgaW5kaWNhdG9yIHN0cmluZyBhdmFpbGFibGUnO1xuICAgIH1cbiAgICByZXR1cm4gaW5kaWNhdG9yO1xuICB9XG5cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2ltdWxhdG9yWGNvZGU4O1xuIl0sInNvdXJjZVJvb3QiOiIuLi8uLiJ9
